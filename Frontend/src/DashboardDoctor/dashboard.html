<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Doctor Dashboard â€” IQ Assessment</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="./style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<div class="header-wrapper">
    <header class="header container">
        <div class="logo-section">
            <i class="fa-solid fa-user-doctor" style="color:#2563eb; font-size:1.5rem;"></i>
            <h1>Doctor Dashboard</h1>
        </div>
        <div class="user-menu">
            <div id="headerDocName" style="color:#64748b; font-weight:500;">Loading...</div>
            <div class="separator"></div>
            <button onclick="handleLogout()" class="logout-btn-header">
                <i class="fa-solid fa-right-from-bracket"></i> Logout
            </button>
        </div>
    </header>
</div>

<div class="container main-layout">
    <div class="tabs" role="tablist" aria-label="Main tabs">
        <button class="tab-button active" data-tab="overviewTab">Overview</button>
        <button class="tab-button" data-tab="patientsTab">Patients</button>
        <button class="tab-button" data-tab="analyticsTab">Analytics</button>
    </div>

    <div class="layout">
        
        <div class="card profile-card">
            <div class="doctor-profile">
                <div class="avatar-circle">DR</div>
                <div class="doc-info">
                    <h2 id="docName">Loading...</h2>
                    <p id="docSpecialty" class="badge-role">Specialist</p>
                    <p id="docClinic" style="font-size:0.85rem; color:#64748b; margin-top:5px;">Kids Memory Clinic</p>
                </div>
            </div>

            <hr class="divider">

            <div class="contact-section">
                <p class="section-title">Contact Info</p>
                
                <div class="contact-item">
                    <div class="icon-box"><i class="fa-solid fa-phone"></i></div>
                    <p id="docPhone">...</p>
                </div>

                <div class="contact-item">
                    <div class="icon-box"><i class="fa-solid fa-envelope"></i></div>
                    <p id="docEmail">...</p>
                </div>
            </div>

            <div class="mini-stats">
                <div class="mini-stat-item">
                    <div class="value" id="leftTotalPatients">0</div>
                    <div class="label">Patients</div>
                </div>
                <div class="mini-stat-item">
                    <div class="value" id="leftAssessments">0</div>
                    <div class="label">Sessions</div>
                </div>
            </div>
        </div> 

        <div class="content">
            
            <div class="kpi-row">
                <div class="kpi card">
                    <div class="icon-bg blue"><i class="fa-solid fa-users"></i></div>
                    <div class="kpi-info">
                        <div class="num" id="kpiTotalPatients">0</div>
                        <div class="lbl">Total Patients</div>
                    </div>
                </div>
                <div class="kpi card">
                    <div class="icon-bg purple"><i class="fa-solid fa-brain"></i></div>
                    <div class="kpi-info">
                        <div class="num" id="kpiAssessments">0</div>
                        <div class="lbl">Total Sessions</div>
                    </div>
                </div>
                <div class="kpi card">
                    <div class="icon-bg orange"><i class="fa-solid fa-star"></i></div>
                    <div class="kpi-info">
                        <div class="num" id="kpiAvgScore">0</div>
                        <div class="lbl">Avg Score</div>
                    </div>
                </div>
                <div class="kpi card">
    <div class="icon-bg green"><i class="fa-solid fa-gamepad"></i></div>
    <div class="kpi-info">
        <div class="num" id="kpiGamesPlayed">0</div>
        <div class="lbl">Games Played</div>
    </div>
</div>
            </div>

            <section id="overviewTab" class="tab-content active card">
                <div class="welcome-banner">
                    <h3>Welcome back, Doctor!</h3>
                    <p>Select the <b>Patients</b> tab to manage your list or link a new child account.</p>
                </div>
                <div class="tip-box">
                    <h4><i class="fa-solid fa-lightbulb"></i> Quick Tip</h4>
                    <p>To view detailed AI analytics, go to the Patients tab and click "View" next to a child's name.</p>
                </div>
            </section>

            <section id="patientsTab" class="tab-content card hidden">
                <div class="section-header">
                    <h3>Patient Management</h3>
                </div>
                
                <div class="link-patient-box">
                    <h4>ðŸ”— Link New Patient</h4>
                    <div class="input-group">
                        <input id="linkEmail" type="email" placeholder="Enter child's email address...">
                        <button onclick="linkPatient()" class="btn-primary">Link Child</button>
                    </div>
                    <div id="linkMsg"></div>
                </div>

                <div class="controls">
                    <input id="searchInput" type="text" placeholder="Search by name..." />
                    <select id="catFilter">
                        <option value="">All Categories</option>
                        <option value="Visual">Visual Memory</option>
                        <option value="Auditory">Auditory Memory</option>
                        <option value="Working">Working Memory</option>
                        <option value="Episodic">Episodic Memory</option>
                    </select>
                </div>

                <div class="table-responsive">
                    <table class="patients-table">
                        <thead>
                            <tr>
                                <th>Child Name</th>
                                <th>Age</th>
                                <th>Parent</th>
                                <th>Last Played</th>
                                <th>Score</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="patientTableBody">
                            </tbody>
                    </table>
                </div>
            </section>

            <section id="analyticsTab" class="tab-content card hidden">
    <div class="analytics-header">
        <div class="child-profile-mini">
            <div class="avatar-circle small" id="childAvatar">--</div>
            <div>
                <h3 id="childName">Select a child</h3>
                <p id="childSubtitle">Click View in Patients tab</p>
            </div>
        </div>
        <div class="ai-box" id="aiInsights">
            <i class="fa-solid fa-robot"></i> Select a patient to see AI insights.
        </div>
    </div>

    <div class="chart-row-full">
        <div class="chart-container">
            <h4>Performance Trend History</h4>
            <canvas id="iqTrend"></canvas>
        </div>
    </div>

    <div class="chart-row-split">
        <div class="chart-container">
            <h4>No. of Games Played (by Category)</h4>
            <canvas id="categoryChart"></canvas>
        </div>
        <div class="chart-container">
            <h4>Historical summary score (Weighted)</h4>
            <canvas id="cognitiveRadar"></canvas>
        </div>
    </div>
</section>

        </div> 
    </div>
</div>

<script src="../../assets/js/SessionManager.js"></script>
<script src="./script.js"></script>
</body>
</html>